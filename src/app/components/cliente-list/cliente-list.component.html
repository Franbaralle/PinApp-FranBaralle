<div class="list-container">
  <div class="header">
    <h2>Lista de Clientes</h2>
    <button class="btn btn-primary" (click)="abrirModal()">
      + Nuevo Cliente
    </button>
  </div>

  <!-- Estadísticas -->
  <div class="estadisticas">
    <div class="stat-card">
      <h3>Total de Clientes</h3>
      <p class="stat-value">{{ todosClientes.length }}</p>
    </div>
    <div class="stat-card">
      <h3>Promedio de Edad</h3>
      <p class="stat-value">{{ promedioEdad | number:'1.0-0' }} años</p>
    </div>
    <div class="stat-card">
      <h3>Desviación Estándar</h3>
      <p class="stat-value">{{ desviacionEstandar | number:'1.0-0' }}</p>
    </div>
  </div>

  <!-- Filtros -->
  <div class="filtros-container">
    <h3>Filtros</h3>
    <div class="filtros">
      <div class="filtro-group">
        <label for="filtroNombre">Buscar por Nombre/Apellido</label>
        <input
          type="text"
          id="filtroNombre"
          [(ngModel)]="filtroNombre"
          (ngModelChange)="aplicarFiltros()"
          placeholder="Escriba para filtrar..."
        />
      </div>

      <div class="filtro-group">
        <label for="filtroEdadMin">Edad Mínima</label>
        <input
          type="number"
          id="filtroEdadMin"
          [(ngModel)]="filtroEdadMin"
          (ngModelChange)="aplicarFiltros()"
          placeholder="Min"
          min="0"
        />
      </div>

      <div class="filtro-group">
        <label for="filtroEdadMax">Edad Máxima</label>
        <input
          type="number"
          id="filtroEdadMax"
          [(ngModel)]="filtroEdadMax"
          (ngModelChange)="aplicarFiltros()"
          placeholder="Max"
          min="0"
        />
      </div>

      <div class="filtro-group">
        <button class="btn btn-secondary" (click)="limpiarFiltros()">
          Limpiar Filtros
        </button>
      </div>
    </div>
  </div>

  <!-- Tabla de clientes -->
  <div class="table-container">
    <p *ngIf="clientesFiltrados.length === 0" class="no-data">
      No hay clientes registrados o no se encontraron resultados.
    </p>

    <table *ngIf="clientesFiltrados.length > 0">
      <thead>
        <tr>
            <th (click)="ordenarPor('nombre')" class="sortable">
                Nombre {{ getIconoOrden('nombre') }}
            </th>
            <th (click)="ordenarPor('apellido')" class="sortable">
                Apellido {{ getIconoOrden('apellido') }}
            </th>
            <th>DNI</th>
          <th (click)="ordenarPor('edad')" class="sortable">
            Edad {{ getIconoOrden('edad') }}
          </th>
          <th (click)="ordenarPor('fecha')" class="sortable">
            Fecha de Nacimiento {{ getIconoOrden('fecha') }}
          </th>
          <th>Email</th>
          <th>Teléfono</th>
          <th>Acciones</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let cliente of clientesFiltrados">
            <td>{{ cliente.nombre }}</td>
            <td>{{ cliente.apellido }}</td>
            <td>{{ cliente.dni }}</td>
          <td>{{ cliente.edad }}</td>
          <td>{{ cliente.fechaNacimiento | formatoFechaNacimiento }}</td>
          <td>{{ cliente.email || '-' }}</td>
          <td>{{ cliente.telefono || '-' }}</td>
          <td class="actions">
            <button 
              class="btn-delete" 
              (click)="eliminarCliente(cliente.id)"
              title="Eliminar"
            >
              <span class="material-icons">delete</span>
            </button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <div class="resultados-info">
    Mostrando {{ clientesFiltrados.length }} de {{ todosClientes.length }} clientes
  </div>
</div>

<!-- Modal para crear cliente -->
<app-cliente-modal 
  [isOpen]="mostrarModal" 
  (closeModal)="cerrarModal()"
  (clienteCreado)="onClienteCreado()">
</app-cliente-modal>
